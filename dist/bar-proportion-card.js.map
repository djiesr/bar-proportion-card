{"version":3,"file":"bar-proportion-card.js","mappings":"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","sources":["webpack://bar-proportion-card/./src/bar-proportion-editor.js","webpack://bar-proportion-card/webpack/bootstrap","webpack://bar-proportion-card/./src/bar-proportion-card.js","webpack://bar-proportion-card/./src/bar-proportion-utils.js","webpack://bar-proportion-card/./src/bar-proportion-styles.js"],"sourcesContent":["class BarProportionCardEditor extends HTMLElement {\n  static get styles() {\n    return `\n      .card-config {\n        padding: 16px;\n      }\n      .row {\n        display: flex;\n        flex-direction: column;\n        margin-top: 8px;\n      }\n      .entities {\n        margin-top: 8px;\n      }\n      .entity-row {\n        display: flex;\n        gap: 8px;\n        margin-top: 8px;\n        align-items: center;\n      }\n    `;\n  }\n\n  setConfig(config) {\n    this._config = config;\n    this.render();\n  }\n\n  set hass(hass) {\n    this._hass = hass;\n    this.render();\n  }\n\n  render() {\n    if (!this._config || !this._hass) return;\n\n    if (!this.shadowRoot) {\n      this.attachShadow({ mode: 'open' });\n    }\n\n    this.shadowRoot.innerHTML = `\n      <style>${BarProportionCardEditor.styles}</style>\n      <div class=\"card-config\">\n        <div class=\"row\">\n          <ha-textfield\n            label=\"Titre\"\n            .value=\"${this._config.title || ''}\"\n            @change=\"${this._valueChanged}\"\n            .configValue=${'title'}\n          ></ha-textfield>\n        </div>\n\n        <div class=\"row\">\n          <ha-select\n            label=\"Mode d'affichage\"\n            .value=\"${this._config.display_mode || 'percentage'}\"\n            @selected=\"${this._valueChanged}\"\n            .configValue=${'display_mode'}\n          >\n            <mwc-list-item value=\"percentage\">Pourcentage</mwc-list-item>\n            <mwc-list-item value=\"value\">Valeur</mwc-list-item>\n          </ha-select>\n        </div>\n\n        <div class=\"row\">\n          <ha-textfield\n            label=\"Décimales\"\n            type=\"number\"\n            min=\"0\"\n            max=\"5\"\n            .value=\"${this._config.decimals || 0}\"\n            @change=\"${this._valueChanged}\"\n            .configValue=${'decimals'}\n          ></ha-textfield>\n        </div>\n\n        <div class=\"row\">\n          <ha-textfield\n            label=\"Unité\"\n            .value=\"${this._config.unit || ''}\"\n            @change=\"${this._valueChanged}\"\n            .configValue=${'unit'}\n          ></ha-textfield>\n        </div>\n\n        <div class=\"entities\">\n          ${(this._config.entities || []).map((entity, index) => `\n            <div class=\"entity-row\">\n              <ha-entity-picker\n                .hass=${this._hass}\n                .value=\"${entity.entity || ''}\"\n                .index=\"${index}\"\n                @value-changed=\"${this._entityChanged}\"\n              ></ha-entity-picker>\n              <ha-textfield\n                .value=\"${entity.name || ''}\"\n                .index=\"${index}\"\n                @change=\"${this._nameChanged}\"\n                label=\"Nom\"\n              ></ha-textfield>\n              <ha-textfield\n                .value=\"${entity.color || ''}\"\n                .index=\"${index}\"\n                @change=\"${this._colorChanged}\"\n                label=\"Couleur\"\n              ></ha-textfield>\n              <ha-icon-button\n                .index=\"${index}\"\n                @click=\"${this._removeEntity}\"\n              >\n                <ha-icon icon=\"mdi:delete\"></ha-icon>\n              </ha-icon-button>\n            </div>\n          `).join('')}\n        </div>\n        \n        <div class=\"row\">\n          <mwc-button @click=\"${this._addEntity}\">\n            Ajouter une entité\n          </mwc-button>\n        </div>\n      </div>\n    `;\n  }\n\n  _valueChanged(ev) {\n    if (!this._config || !this.shadowRoot) return;\n\n    const target = ev.target;\n    const value = target.value;\n    const configValue = target.configValue;\n\n    if (configValue) {\n      if (target.type === 'number') {\n        this._config = { ...this._config, [configValue]: parseInt(value) };\n      } else {\n        this._config = { ...this._config, [configValue]: value };\n      }\n    }\n    this._fireChanged();\n  }\n\n  _entityChanged(ev) {\n    const target = ev.target;\n    const index = parseInt(target.index);\n    const value = ev.detail.value;\n\n    const entities = [...(this._config.entities || [])];\n    entities[index] = { ...entities[index], entity: value };\n    this._config = { ...this._config, entities };\n    this._fireChanged();\n  }\n\n  _nameChanged(ev) {\n    const target = ev.target;\n    const index = parseInt(target.index);\n    const value = target.value;\n\n    const entities = [...(this._config.entities || [])];\n    entities[index] = { ...entities[index], name: value };\n    this._config = { ...this._config, entities };\n    this._fireChanged();\n  }\n\n  _colorChanged(ev) {\n    const target = ev.target;\n    const index = parseInt(target.index);\n    const value = target.value;\n\n    const entities = [...(this._config.entities || [])];\n    entities[index] = { ...entities[index], color: value };\n    this._config = { ...this._config, entities };\n    this._fireChanged();\n  }\n\n  _addEntity() {\n    const entities = [...(this._config.entities || [])];\n    entities.push({\n      entity: '',\n      name: '',\n      color: ''\n    });\n    this._config = { ...this._config, entities };\n    this._fireChanged();\n  }\n\n  _removeEntity(ev) {\n    const index = parseInt(ev.target.index);\n    const entities = [...(this._config.entities || [])];\n    entities.splice(index, 1);\n    this._config = { ...this._config, entities };\n    this._fireChanged();\n  }\n\n  _fireChanged() {\n    const event = new CustomEvent('config-changed', {\n      detail: { config: this._config },\n      bubbles: true,\n      composed: true\n    });\n    this.dispatchEvent(event);\n  }\n}\n\ncustomElements.define('bar-proportion-card-editor', BarProportionCardEditor);\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import styles from './bar-proportion-styles.js';\nimport { formatDisplay, processEntityData } from './bar-proportion-utils.js';\nimport './bar-proportion-editor.js';\n\nclass BarProportionCard extends HTMLElement {\n\n  constructor() {\n    super();\n    console.log('[BarProportionCard] Constructor');\n  }\n  \n  static getConfigElement() {\n    console.log('[BarProportionCard] getConfigElement - creating editor');\n    const editor = document.createElement('bar-proportion-card-editor');\n    console.log('[BarProportionCard] getConfigElement - editor created:', editor);\n    return editor;\n  }\n  \n  static getStubConfig() {\n    console.log('[BarProportionCard] getStubConfig called');\n    return {\n      title: \"Ma barre de proportion\",\n      entities: [\n        {\n          entity: \"\",\n          name: \"\",\n          color: \"var(--primary-color)\"\n        }\n      ],\n      display_mode: \"percentage\",\n      decimals: 0,\n      unit: \"\"\n    };\n  }\n\n  setConfig(config) {\n    if (!config.entities || !Array.isArray(config.entities)) {\n      throw new Error('Please define entities');\n    }\n    this.config = {\n      display_mode: 'percentage',\n      unit: '',\n      decimals: 0,\n      ...config\n    };\n  }\n\n  set hass(hass) {\n    this._hass = hass;\n    if (!this.content) {\n      this.content = document.createElement('div');\n      this.appendChild(this.content);\n    }\n    this.updateCard();\n  }\n\n  updateCard() {\n    const values = this.config.entities.map(entity => \n      processEntityData(entity, this._hass)\n    );\n\n    const total = values.reduce((sum, item) => sum + item.value, 0);\n    \n    this.content.innerHTML = `\n      <style>${styles}</style>\n      <ha-card>\n        ${this.config.title ? `<h1 class=\"header\">${this.config.title}</h1>` : ''}\n        \n        <div class=\"bar-container\">\n          ${values.map(item => `\n            <div class=\"bar-section\" \n                 style=\"width: ${(item.value / total * 100)}%; background-color: ${item.color};\">\n            </div>\n          `).join('')}\n        </div>\n\n        <div class=\"legend\">\n          ${values.map(item => `\n            <div class=\"legend-item\">\n              <div class=\"legend-color\" style=\"background-color: ${item.color};\"></div>\n              <span>${item.name} (${formatDisplay(item.value, total, this.config)})</span>\n            </div>\n          `).join('')}\n        </div>\n      </ha-card>\n    `;\n  }\n}\n\ncustomElements.define('bar-proportion-card', BarProportionCard);\n","export function formatDisplay(value, total, config) {\n  if (config.display_mode === 'percentage') {\n    return `${(value / total * 100).toFixed(config.decimals)}%`;\n  } else {\n    return `${value.toFixed(config.decimals)}${config.unit}`;\n  }\n}\n\nexport function processEntityData(entity, hass) {\n  const state = hass.states[entity.entity];\n  if (!state) {\n    console.warn(`Entity ${entity.entity} not found`);\n    return {\n      name: entity.name || entity.entity,\n      value: 0,\n      color: entity.color || 'var(--primary-color)'\n    };\n  }\n  return {\n    name: entity.name || state.attributes.friendly_name || entity.entity,\n    value: parseFloat(state.state) || 0,\n    color: entity.color || 'var(--primary-color)'\n  };\n}\n","const styles = `\n  ha-card {\n    background: var(--ha-card-background, var(--card-background-color));\n    border-radius: var(--ha-card-border-radius, 12px);\n    box-shadow: var(--ha-card-box-shadow, 0px 2px 1px -1px rgba(0, 0, 0, 0.2), 0px 1px 1px 0px rgba(0, 0, 0, 0.14), 0px 1px 3px 0px rgba(0, 0, 0, 0.12));\n    color: var(--primary-text-color);\n    padding: 16px;\n  }\n  .header {\n    color: var(--primary-text-color);\n    font-size: var(--ha-card-header-font-size, 24px);\n    line-height: 1.2;\n    margin-bottom: 16px;\n    font-weight: normal;\n  }\n  .bar-container {\n    width: 100%;\n    height: 24px;\n    display: flex;\n    border-radius: 12px;\n    overflow: hidden;\n    background: var(--secondary-background-color);\n    margin: 8px 0;\n  }\n  .bar-section {\n    height: 100%;\n    transition: width 0.5s ease-in-out;\n  }\n  .legend {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 16px;\n    margin-top: 12px;\n    color: var(--primary-text-color);\n  }\n  .legend-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n  }\n  .legend-color {\n    width: 12px;\n    height: 12px;\n    border-radius: 3px;\n  }\n`;\n\nexport default styles;\n"],"names":["BarProportionCardEditor","_HTMLElement","_classCallCheck","_callSuper","arguments","_inherits","key","get","value","config","this","_config","render","set","hass","_hass","_this","shadowRoot","attachShadow","mode","innerHTML","concat","styles","title","_valueChanged","display_mode","decimals","unit","entities","map","entity","index","_entityChanged","name","_nameChanged","color","_colorChanged","_removeEntity","join","_addEntity","ev","target","configValue","type","_objectSpread","_defineProperty","parseInt","_fireChanged","detail","_toConsumableArray","push","splice","event","CustomEvent","bubbles","composed","dispatchEvent","_wrapNativeSuper","HTMLElement","customElements","define","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","BarProportionCard","console","log","Array","isArray","Error","content","document","createElement","appendChild","updateCard","_this2","values","state","states","attributes","friendly_name","parseFloat","warn","processEntityData","total","reduce","sum","item","toFixed","formatDisplay","editor"],"sourceRoot":""}