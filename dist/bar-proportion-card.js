(()=>{var e={674:()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||i(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function r(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t,n){return(t=u(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(e){if("string"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}function l(e){var t="function"==typeof Map?new Map:void 0;return l=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(s())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var o=new(e.bind.apply(e,r));return n&&f(o,n.prototype),o}(e,arguments,p(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),f(n,e)},l(e)}function s(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(s=function(){return!!e})()}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var d=function(n){function a(){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=function(t,n,r){return n=p(n),function(t,n){if(n&&("object"==e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t)}(t,s()?Reflect.construct(n,r||[],p(t).constructor):n.apply(t,r))}(this,a)).attachShadow({mode:"open"}),t._initialized=!1,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(a,n),u=a,d=[{key:"styles",get:function(){return"\n      .card-config {\n        padding: 16px;\n      }\n      .row {\n        display: flex;\n        flex-direction: column;\n        margin-top: 8px;\n      }\n      .entities {\n        margin-top: 8px;\n      }\n      .entity-row {\n        display: flex;\n        gap: 8px;\n        margin-top: 8px;\n        align-items: center;\n      }\n    "}}],(l=[{key:"firstUpdated",value:function(){this._initialized=!0,this._createForm()}},{key:"hass",set:function(e){this._hass=e,this._initialized||this.firstUpdated()}},{key:"setConfig",value:function(e){this._config=e,this._initialized||this.firstUpdated()}},{key:"_createForm",value:function(){var e=this;if(this._hass&&this._config){var t=document.createElement("div");t.className="card-config";var n=document.createElement("style");n.textContent=a.styles,t.appendChild(n);var r=this._createRow(),o=document.createElement("ha-textfield");o.label="Titre",o.value=this._config.title||"",o.addEventListener("change",(function(t){return e._valueChanged("title",t.target.value)})),r.appendChild(o),t.appendChild(r);var c=this._createRow(),u=document.createElement("ha-select");u.label="Mode d'affichage",u.value=this._config.display_mode||"percentage",[["percentage","Pourcentage"],["value","Valeur"]].forEach((function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,2),n=t[0],r=t[1],o=document.createElement("mwc-list-item");o.value=n,o.innerText=r,u.appendChild(o)})),u.addEventListener("selected",(function(t){return e._valueChanged("display_mode",t.target.value)})),c.appendChild(u),t.appendChild(c);var l=this._createRow(),s=document.createElement("ha-textfield");s.label="Décimales",s.type="number",s.min="0",s.max="5",s.value=this._config.decimals||0,s.addEventListener("change",(function(t){return e._valueChanged("decimals",parseInt(t.target.value))})),l.appendChild(s),t.appendChild(l);var f=this._createRow(),p=document.createElement("ha-textfield");p.label="Unité",p.value=this._config.unit||"",p.addEventListener("change",(function(t){return e._valueChanged("unit",t.target.value)})),f.appendChild(p),t.appendChild(f);var d=document.createElement("div");d.className="entities";var h=document.createElement("mwc-button");for(h.innerHTML="Ajouter une entité",h.addEventListener("click",(function(){return e._addEntity()})),this._createEntityRows(d),t.appendChild(d),t.appendChild(h);this.shadowRoot.firstChild;)this.shadowRoot.removeChild(this.shadowRoot.firstChild);this.shadowRoot.appendChild(t)}}},{key:"_createRow",value:function(){var e=document.createElement("div");return e.className="row",e}},{key:"_createEntityRows",value:function(e){var t=this;e.innerHTML="",(this._config.entities||[]).forEach((function(n,r){var o=document.createElement("div");o.className="entity-row";var i=document.createElement("ha-entity-picker");i.hass=t._hass,i.value=n.entity,i.allowCustomEntity=!0,i.index=r,i.addEventListener("value-changed",(function(e){t._entityChanged(r,e.detail.value)}));var a=document.createElement("ha-textfield");a.label="Nom",a.value=n.name||"",a.addEventListener("change",(function(e){t._nameChanged(r,e.target.value)}));var c=document.createElement("ha-textfield");c.label="Couleur",c.value=n.color||"",c.addEventListener("change",(function(e){t._colorChanged(r,e.target.value)}));var u=document.createElement("ha-icon-button");u.innerHTML='<ha-icon icon="mdi:delete"></ha-icon>',u.addEventListener("click",(function(){t._removeEntity(r)})),o.appendChild(i),o.appendChild(a),o.appendChild(c),o.appendChild(u),e.appendChild(o)}))}},{key:"_valueChanged",value:function(e,t){this._config&&(this._config=r(r({},this._config),{},o({},e,t)),this._fireChanged())}},{key:"_entityChanged",value:function(e,n){var o=t(this._config.entities||[]);o[e]=r(r({},o[e]),{},{entity:n}),this._valueChanged("entities",o)}},{key:"_nameChanged",value:function(e,n){var o=t(this._config.entities||[]);o[e]=r(r({},o[e]),{},{name:n}),this._valueChanged("entities",o)}},{key:"_colorChanged",value:function(e,n){var o=t(this._config.entities||[]);o[e]=r(r({},o[e]),{},{color:n}),this._valueChanged("entities",o)}},{key:"_addEntity",value:function(){var e=t(this._config.entities||[]);e.push({entity:"",name:"",color:""}),this._valueChanged("entities",e),this._createEntityRows(this.shadowRoot.querySelector(".entities"))}},{key:"_removeEntity",value:function(e){var n=t(this._config.entities||[]);n.splice(e,1),this._valueChanged("entities",n),this._createEntityRows(this.shadowRoot.querySelector(".entities"))}},{key:"_fireChanged",value:function(){var e=new CustomEvent("config-changed",{detail:{config:this._config},bubbles:!0,composed:!0});this.dispatchEvent(e)}}])&&c(u.prototype,l),d&&c(u,d),Object.defineProperty(u,"prototype",{writable:!1}),u;var u,l,d}(l(HTMLElement));customElements.define("bar-proportion-card-editor",d)}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function r(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,i(r.key),r)}}function i(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}function a(e){var t="function"==typeof Map?new Map:void 0;return a=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(c())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var o=new(e.bind.apply(e,r));return n&&u(o,n.prototype),o}(e,arguments,l(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),u(n,e)},a(e)}function c(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(c=function(){return!!e})()}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}n(674);var s=function(n){function i(){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),t=function(t,n,r){return n=l(n),function(t,n){if(n&&("object"==e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t)}(t,c()?Reflect.construct(n,r||[],l(t).constructor):n.apply(t,r))}(this,i),console.log("[BarProportionCard] Constructor"),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(i,n),a=i,s=[{key:"setConfig",value:function(e){if(!e.entities||!Array.isArray(e.entities))throw new Error("Please define entities");this.config=function(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?t(Object(o),!0).forEach((function(t){r(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({display_mode:"percentage",unit:"",decimals:0},e)}},{key:"hass",set:function(e){this._hass=e,this.content||(this.content=document.createElement("div"),this.appendChild(this.content)),this.updateCard()}},{key:"updateCard",value:function(){var e=this,t=this.config.entities.map((function(t){return function(e,t){var n=t.states[e.entity];return n?{name:e.name||n.attributes.friendly_name||e.entity,value:parseFloat(n.state)||0,color:e.color||"var(--primary-color)"}:(console.warn("Entity ".concat(e.entity," not found")),{name:e.name||e.entity,value:0,color:e.color||"var(--primary-color)"})}(t,e._hass)})),n=t.reduce((function(e,t){return e+t.value}),0);this.content.innerHTML="\n      <style>".concat("\n  ha-card {\n    background: var(--ha-card-background, var(--card-background-color));\n    border-radius: var(--ha-card-border-radius, 12px);\n    box-shadow: var(--ha-card-box-shadow, 0px 2px 1px -1px rgba(0, 0, 0, 0.2), 0px 1px 1px 0px rgba(0, 0, 0, 0.14), 0px 1px 3px 0px rgba(0, 0, 0, 0.12));\n    color: var(--primary-text-color);\n    padding: 16px;\n  }\n  .header {\n    color: var(--primary-text-color);\n    font-size: var(--ha-card-header-font-size, 24px);\n    line-height: 1.2;\n    margin-bottom: 16px;\n    font-weight: normal;\n  }\n  .bar-container {\n    width: 100%;\n    height: 24px;\n    display: flex;\n    border-radius: 12px;\n    overflow: hidden;\n    background: var(--secondary-background-color);\n    margin: 8px 0;\n  }\n  .bar-section {\n    height: 100%;\n    transition: width 0.5s ease-in-out;\n  }\n  .legend {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 16px;\n    margin-top: 12px;\n    color: var(--primary-text-color);\n  }\n  .legend-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n  }\n  .legend-color {\n    width: 12px;\n    height: 12px;\n    border-radius: 3px;\n  }\n","</style>\n      <ha-card>\n        ").concat(this.config.title?'<h1 class="header">'.concat(this.config.title,"</h1>"):"",'\n        \n        <div class="bar-container">\n          ').concat(t.map((function(e){return'\n            <div class="bar-section" \n                 style="width: '.concat(e.value/n*100,"%; background-color: ").concat(e.color,';">\n            </div>\n          ')})).join(""),'\n        </div>\n\n        <div class="legend">\n          ').concat(t.map((function(t){return'\n            <div class="legend-item">\n              <div class="legend-color" style="background-color: '.concat(t.color,';"></div>\n              <span>').concat(t.name," (").concat(function(e,t,n){return"percentage"===n.display_mode?"".concat((e/t*100).toFixed(n.decimals),"%"):"".concat(e.toFixed(n.decimals)).concat(n.unit)}(t.value,n,e.config),")</span>\n            </div>\n          ")})).join(""),"\n        </div>\n      </ha-card>\n    ")}}],f=[{key:"getConfigElement",value:function(){console.log("[BarProportionCard] getConfigElement - creating editor");var e=document.createElement("bar-proportion-card-editor");return console.log("[BarProportionCard] getConfigElement - editor created:",e),e}},{key:"getStubConfig",value:function(){return console.log("[BarProportionCard] getStubConfig called"),{title:"Ma barre de proportion",entities:[{entity:"",name:"",color:"var(--primary-color)"}],display_mode:"percentage",decimals:0,unit:""}}}],s&&o(a.prototype,s),f&&o(a,f),Object.defineProperty(a,"prototype",{writable:!1}),a;var a,s,f}(a(HTMLElement));customElements.define("bar-proportion-card",s)})()})();
//# sourceMappingURL=bar-proportion-card.js.map