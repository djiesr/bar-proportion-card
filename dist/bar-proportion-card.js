(()=>{var t={674:()=>{function t(n){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(n)}function n(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function e(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?n(Object(o),!0).forEach((function(n){r(t,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(o,n))}))}return t}function r(t,n,e){return(n=c(n))in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function o(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return i(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?i(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function a(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,c(r.key),r)}}function c(n){var e=function(n){if("object"!=t(n)||!n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var r=e.call(n,"string");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==t(e)?e:e+""}function l(t){var n="function"==typeof Map?new Map:void 0;return l=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(n){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return function(t,n,e){if(u())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,n);var o=new(t.bind.apply(t,r));return e&&s(o,e.prototype),o}(t,arguments,f(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),s(e,t)},l(t)}function u(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(u=function(){return!!t})()}function s(t,n){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},s(t,n)}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}var p=function(n){function i(){var n;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,i),(n=function(n,e,r){return e=f(e),function(n,e){if(e&&("object"==t(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(n)}(n,u()?Reflect.construct(e,r||[],f(n).constructor):e.apply(n,r))}(this,i)).attachShadow({mode:"open"}),n._initialized=!1,n}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&s(t,n)}(i,n),c=i,p=[{key:"styles",get:function(){return"\n      .form-container {\n        display: flex;\n        flex-direction: column;\n        gap: 8px;\n        padding: 16px;\n      }\n      .row {\n        padding: 8px 0;\n        display: flex;\n        flex-direction: column;\n      }\n      .entities {\n        display: flex;\n        flex-direction: column;\n        gap: 8px;\n      }\n      .entity-row {\n        display: flex;\n        gap: 8px;\n        align-items: center;\n      }\n      .entity-row ha-icon {\n        cursor: pointer;\n        color: var(--primary-text-color);\n      }\n      mwc-button {\n        margin-top: 8px;\n      }\n      ha-textfield {\n        width: 100%;\n      }\n    "}}],(l=[{key:"hass",set:function(t){this._hass=t,this._config&&!this._initialized&&this._initialize()}},{key:"setConfig",value:function(t){this._config=t,this._hass&&!this._initialized&&this._initialize()}},{key:"_initialize",value:function(){this._initialized=!0,this._createForm()}},{key:"_title",get:function(){var t;return(null===(t=this._config)||void 0===t?void 0:t.title)||""}},{key:"_entities",get:function(){var t;return(null===(t=this._config)||void 0===t?void 0:t.entities)||[]}},{key:"_display_mode",get:function(){var t;return(null===(t=this._config)||void 0===t?void 0:t.display_mode)||"percentage"}},{key:"_decimals",get:function(){var t;return(null===(t=this._config)||void 0===t?void 0:t.decimals)||0}},{key:"_unit",get:function(){var t;return(null===(t=this._config)||void 0===t?void 0:t.unit)||""}},{key:"_createForm",value:function(){var t=this;if(this._hass&&this._config){var n=document.createElement("div");for(n.className="form-container",n.innerHTML="\n      <style>".concat(i.styles,'</style>\n      <div class="row">\n        <ha-textfield\n          label="Titre"\n          .value="').concat(this._title,'"\n          @change="').concat(this._valueChanged,'"\n          id="title"\n        ></ha-textfield>\n      </div>\n      \n      <div class="row">\n        <ha-select\n          label="Mode d\'affichage"\n          .value="').concat(this._display_mode,'"\n          @selected="').concat(this._displayModeChanged,'"\n          id="display_mode"\n        >\n          <mwc-list-item value="percentage">Pourcentage</mwc-list-item>\n          <mwc-list-item value="value">Valeur</mwc-list-item>\n        </ha-select>\n      </div>\n\n      <div class="row">\n        <ha-textfield\n          label="Décimales"\n          type="number"\n          min="0"\n          max="5"\n          .value="').concat(this._decimals,'"\n          @change="').concat(this._valueChanged,'"\n          id="decimals"\n        ></ha-textfield>\n      </div>\n\n      <div class="row">\n        <ha-textfield\n          label="Unité"\n          .value="').concat(this._unit,'"\n          @change="').concat(this._valueChanged,'"\n          id="unit"\n        ></ha-textfield>\n      </div>\n\n      <div class="row">\n        <label>Entités</label>\n        <div class="entities" id="entities">\n          ').concat(this._entities.map((function(n,e){return t._createEntityRow(n,e)})).join(""),'\n        </div>\n        <mwc-button @click="').concat(this._addEntity,'">Ajouter une entité</mwc-button>\n      </div>\n    ');this.shadowRoot.firstChild;)this.shadowRoot.removeChild(this.shadowRoot.firstChild);this.shadowRoot.appendChild(n),this._entities.forEach((function(n,e){var r=t.shadowRoot.querySelector("#entity-".concat(e));r&&(r.hass=t._hass)}))}}},{key:"_createEntityRow",value:function(t,n){var e=this;return this._hass?"\n      ".concat(0===n?'\n        <div class="entity-header" style="display: flex; gap: 8px; margin-bottom: 8px; color: var(--primary-text-color);">\n          <div style="flex-grow: 1; min-width: 200px;">Entité</div>\n          <div style="flex-grow: 1; min-width: 150px;">Nom personnalisé</div>\n          <div style="min-width: 120px;">Couleur</div>\n          <div style="width: 48px;"></div>\n        </div>\n      ':"",'\n      <div class="entity-row">\n        <ha-entity-picker\n          id="entity-').concat(n,'"\n          .hass="').concat(this._hass,'"\n          .value="').concat(t.entity,'"\n          label="Sélectionner une entité"\n          allow-custom-entity\n          @value-changed="').concat((function(t){return e._entityChanged(n,t)}),'"\n          style="flex-grow: 1; min-width: 200px;"\n        ></ha-entity-picker>\n        <ha-textfield\n          .value="').concat(t.name||"",'"\n          label="Nom affiché"\n          @change="').concat((function(t){return e._nameChanged(n,t)}),'"\n          style="flex-grow: 1; min-width: 150px;"\n        ></ha-textfield>\n        <ha-textfield\n          .value="').concat(t.color||"",'"\n          label="(ex: #FF0000)"\n          @change="').concat((function(t){return e._colorChanged(n,t)}),'"\n          style="min-width: 120px;"\n        ></ha-textfield>\n        <ha-icon-button\n          .path="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"\n          @click="').concat((function(){return e._removeEntity(n)}),'"\n          style="color: var(--primary-text-color); width: 48px;"\n        ></ha-icon-button>\n      </div>\n    '):""}},{key:"_entityChanged",value:function(t,n){var r=o(this._entities);r[t]=e(e({},r[t]),{},{entity:n.detail.value}),this._updateConfig({entities:r})}},{key:"_nameChanged",value:function(t,n){var r=o(this._entities);r[t]=e(e({},r[t]),{},{name:n.target.value}),this._updateConfig({entities:r})}},{key:"_colorChanged",value:function(t,n){var r=o(this._entities);r[t]=e(e({},r[t]),{},{color:n.target.value}),this._updateConfig({entities:r})}},{key:"_addEntity",value:function(){var t=o(this._entities);t.push({entity:"",name:"",color:""}),this._updateConfig({entities:t})}},{key:"_removeEntity",value:function(t){var n=o(this._entities);n.splice(t,1),this._updateConfig({entities:n})}},{key:"_displayModeChanged",value:function(t){this._updateConfig({display_mode:t.target.value})}},{key:"_valueChanged",value:function(t){var n=t.target,e="number"===n.type?Number(n.value):n.value;this._updateConfig(r({},n.id,e))}},{key:"_updateConfig",value:function(t){var n=e(e({},this._config),t),r=new CustomEvent("config-changed",{detail:{config:n},bubbles:!0,composed:!0});this.dispatchEvent(r),this._config=n,this._createForm()}}])&&a(c.prototype,l),p&&a(c,p),Object.defineProperty(c,"prototype",{writable:!1}),c;var c,l,p}(l(HTMLElement));customElements.define("bar-proportion-card-editor",p)}},n={};function e(r){var o=n[r];if(void 0!==o)return o.exports;var i=n[r]={exports:{}};return t[r](i,i.exports,e),i.exports}(()=>{"use strict";function t(n){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(n)}function n(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function r(t,n,e){return(n=i(n))in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function o(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,i(r.key),r)}}function i(n){var e=function(n){if("object"!=t(n)||!n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var r=e.call(n,"string");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==t(e)?e:e+""}function a(t){var n="function"==typeof Map?new Map:void 0;return a=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(n){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return function(t,n,e){if(c())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,n);var o=new(t.bind.apply(t,r));return e&&l(o,e.prototype),o}(t,arguments,u(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),l(e,t)},a(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function l(t,n){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},l(t,n)}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}e(674);var s=function(e){function i(){var n;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,i),n=function(n,e,r){return e=u(e),function(n,e){if(e&&("object"==t(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(n)}(n,c()?Reflect.construct(e,r||[],u(n).constructor):e.apply(n,r))}(this,i),console.log("[BarProportionCard] Constructor"),n}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&l(t,n)}(i,e),a=i,s=[{key:"setConfig",value:function(t){if(!t.entities||!Array.isArray(t.entities))throw new Error("Please define entities");this.config=function(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?n(Object(o),!0).forEach((function(n){r(t,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(o,n))}))}return t}({display_mode:"percentage",unit:"",decimals:0},t)}},{key:"hass",set:function(t){this._hass=t,this.content||(this.content=document.createElement("div"),this.appendChild(this.content)),this.updateCard()}},{key:"updateCard",value:function(){var t=this,n=this.config.entities.map((function(n){return function(t,n){var e=n.states[t.entity];return e?{name:t.name||e.attributes.friendly_name||t.entity,value:parseFloat(e.state)||0,color:t.color||"var(--primary-color)"}:(console.warn("Entity ".concat(t.entity," not found")),{name:t.name||t.entity,value:0,color:t.color||"var(--primary-color)"})}(n,t._hass)})),e=n.reduce((function(t,n){return t+n.value}),0);this.content.innerHTML="\n      <style>".concat("\n  ha-card {\n    background: var(--ha-card-background, var(--card-background-color));\n    border-radius: var(--ha-card-border-radius, 12px);\n    box-shadow: var(--ha-card-box-shadow, 0px 2px 1px -1px rgba(0, 0, 0, 0.2), 0px 1px 1px 0px rgba(0, 0, 0, 0.14), 0px 1px 3px 0px rgba(0, 0, 0, 0.12));\n    color: var(--primary-text-color);\n    padding: 16px;\n  }\n  .header {\n    color: var(--primary-text-color);\n    font-size: var(--ha-card-header-font-size, 24px);\n    line-height: 1.2;\n    margin-bottom: 16px;\n    font-weight: normal;\n  }\n  .bar-container {\n    width: 100%;\n    height: 24px;\n    display: flex;\n    border-radius: 12px;\n    overflow: hidden;\n    background: var(--secondary-background-color);\n    margin: 8px 0;\n  }\n  .bar-section {\n    height: 100%;\n    transition: width 0.5s ease-in-out;\n  }\n  .legend {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 16px;\n    margin-top: 12px;\n    color: var(--primary-text-color);\n  }\n  .legend-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n  }\n  .legend-color {\n    width: 12px;\n    height: 12px;\n    border-radius: 3px;\n  }\n","</style>\n      <ha-card>\n        ").concat(this.config.title?'<h1 class="header">'.concat(this.config.title,"</h1>"):"",'\n        \n        <div class="bar-container">\n          ').concat(n.map((function(t){return'\n            <div class="bar-section" \n                 style="width: '.concat(t.value/e*100,"%; background-color: ").concat(t.color,';">\n            </div>\n          ')})).join(""),'\n        </div>\n\n        <div class="legend">\n          ').concat(n.map((function(n){return'\n            <div class="legend-item">\n              <div class="legend-color" style="background-color: '.concat(n.color,';"></div>\n              <span>').concat(n.name," (").concat(function(t,n,e){return"percentage"===e.display_mode?"".concat((t/n*100).toFixed(e.decimals),"%"):"".concat(t.toFixed(e.decimals)).concat(e.unit)}(n.value,e,t.config),")</span>\n            </div>\n          ")})).join(""),"\n        </div>\n      </ha-card>\n    ")}}],f=[{key:"getConfigElement",value:function(){console.log("[BarProportionCard] getConfigElement - creating editor");var t=document.createElement("bar-proportion-card-editor");return console.log("[BarProportionCard] getConfigElement - editor created:",t),t}},{key:"getStubConfig",value:function(){return console.log("[BarProportionCard] getStubConfig called"),{title:"Ma barre de proportion",entities:[{entity:"",name:"",color:"var(--primary-color)"}],display_mode:"percentage",decimals:0,unit:""}}}],s&&o(a.prototype,s),f&&o(a,f),Object.defineProperty(a,"prototype",{writable:!1}),a;var a,s,f}(a(HTMLElement));customElements.define("bar-proportion-card",s)})()})();
//# sourceMappingURL=bar-proportion-card.js.map